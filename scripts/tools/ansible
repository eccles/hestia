#
# Installs ansible
#
# This file is sourced
#
. ./scripts/log
. ./scripts/os

ansible_check() {
	ANSIBLE=$(which ansible)
	if [ $? -ne 0 ]
	then
    		log_warn "Please install ansible"
	else
		VERSION=$(ansible_version)
    		log_info "ansible $VERSION available at $ANSIBLE"
	fi
}

ansible_install() {
	ANSIBLE=$(which ansible)
	if [ $? -ne 0 ]
	then
		case $OS_TYPE in
		"ubuntu"| "pop")
			log_info "Installing ansible on $OS_TYPE"
			sudo apt update
			sudo apt install ansible
			;;
		"fedora")
			log_info "Installing ansible on $OS_TYPE"
			sudo dnf install ansible
			;;
                *)
			log_error "Unknown OS $OS_TYPE"
			;;

		esac
	else
		VERSION=$(ansible_version)
		log_info "ansible $VERSION is already installed at $ANSIBLE"
	fi
}

ansible_version() {
	ansible --version | grep ^ansible | cut -d' ' -f2
}
